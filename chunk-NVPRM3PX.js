import{a as M,b as j}from"./chunk-6IJTW5S2.js";import{$a as V,Aa as y,C as w,Ca as h,D as r,Da as I,J as f,K as k,Ka as S,P as _,Pa as E,Qa as R,T as m,U as t,V as i,Va as F,Wa as D,Xa as T,a as A,ba as v,bb as B,da as u,ea as s,f as C,i as b,jb as O,pa as x,q as p,qa as a,r as g,ra as d}from"./chunk-SW3RDXTT.js";import"./chunk-7CGTOI24.js";function $(c,n){if(c&1&&(t(0,"div",11),a(1),i()),c&2){let e=s();r(),d(e.error)}}function P(c,n){if(c&1){let e=v();t(0,"div",12)(1,"button",13),u("click",function(){p(e);let l=s();return g(l.filterByCategory("all"))}),a(2,"All"),i(),t(3,"button",13),u("click",function(){p(e);let l=s();return g(l.filterByCategory("event"))}),a(4,"\u{1F389} Events"),i(),t(5,"button",13),u("click",function(){p(e);let l=s();return g(l.filterByCategory("alert"))}),a(6,"\u26A0\uFE0F Alerts"),i(),t(7,"button",13),u("click",function(){p(e);let l=s();return g(l.filterByCategory("update"))}),a(8,"\u{1F4E2} Updates"),i()()}if(c&2){let e=s();r(),x(e.categoryFilter==="all"?"px-3 py-1 rounded-full bg-indigo-600 text-white":"px-3 py-1 rounded-full bg-gray-100"),r(2),x(e.categoryFilter==="event"?"px-3 py-1 rounded-full bg-indigo-600 text-white":"px-3 py-1 rounded-full bg-gray-100"),r(2),x(e.categoryFilter==="alert"?"px-3 py-1 rounded-full bg-indigo-600 text-white":"px-3 py-1 rounded-full bg-gray-100"),r(2),x(e.categoryFilter==="update"?"px-3 py-1 rounded-full bg-indigo-600 text-white":"px-3 py-1 rounded-full bg-gray-100")}}function L(c,n){c&1&&(t(0,"div",14),a(1,"Loading announcements..."),i())}function z(c,n){if(c&1){let e=v();t(0,"button",17),u("click",function(){let l=p(e).$implicit,U=s(2);return g(U.selectAnnouncement(l))}),t(1,"div",18),a(2),i(),t(3,"h3",19),a(4),i(),t(5,"p",20),a(6),y(7,"slice"),i(),t(8,"div",21)(9,"span",22),a(10),i(),t(11,"span",23),a(12),y(13,"date"),i()()()}if(c&2){let e=n.$implicit,o=s(2);r(2),d(o.getCategoryIcon(e.category)),r(2),d(e.title||"Untitled Announcement"),r(2),d(e.content?I(7,5,e.content,0,150)+"...":"No details provided."),r(4),d(o.getCategoryLabel(e.category)),r(2),d(h(13,9,e.createdAt,"short"))}}function q(c,n){if(c&1&&(t(0,"div",15),_(1,z,14,12,"button",16),i()),c&2){let e=s();r(),m("ngForOf",e.getFilteredAnnouncements())}}function G(c,n){c&1&&(t(0,"div",24),a(1,"No announcements in this category"),i())}function H(c,n){if(c&1&&(t(0,"div",35),a(1,"Attachment: "),t(2,"a",36),a(3,"Download"),i()()),c&2){let e=s(2);r(2),m("href",e.selectedAnnouncement.attachmentUrl,w)}}function J(c,n){if(c&1){let e=v();t(0,"div",25),u("click",function(){p(e);let l=s();return g(l.closeDetails())}),t(1,"div",26),u("click",function(l){return p(e),g(l.stopPropagation())}),t(2,"button",27),u("click",function(){p(e);let l=s();return g(l.closeDetails())}),a(3,"\u2715"),i(),t(4,"div",28)(5,"div",29),a(6),i(),t(7,"h2",30),a(8),i()(),t(9,"div",31)(10,"span",32),a(11),i(),t(12,"span"),a(13),y(14,"date"),i()(),t(15,"div",33),a(16),i(),_(17,H,4,1,"div",34),i()()}if(c&2){let e=s();r(6),d(e.getCategoryIcon(e.selectedAnnouncement.category)),r(2),d(e.selectedAnnouncement.title),r(3),d(e.getCategoryLabel(e.selectedAnnouncement.category)),r(2),d(h(14,6,e.selectedAnnouncement.createdAt,"medium")),r(3),d(e.selectedAnnouncement.content),r(),m("ngIf",e.selectedAnnouncement.attachmentUrl)}}var N=class c{constructor(n,e,o){this.announcementService=n;this.router=e;this.cdr=o;this.router.events.pipe(C(l=>l instanceof V),b(this.destroy$)).subscribe(()=>{this.loadAnnouncements()})}announcements=[];loading=!0;error="";selectedAnnouncement=null;categoryFilter="all";destroy$=new A;ngOnInit(){this.loadAnnouncements()}goBack(){this.router.navigate(["/resident"])}loadAnnouncements(){this.loading=!0,this.announcementService.getActiveAnnouncements().pipe(b(this.destroy$)).subscribe({next:n=>{if(this.announcements=n.sort((e,o)=>new Date(o.createdAt).getTime()-new Date(e.createdAt).getTime()),this.selectedAnnouncement){let e=this.announcements.find(o=>o.id===this.selectedAnnouncement.id);this.selectedAnnouncement=e||null}this.loading=!1,this.cdr.markForCheck()},error:n=>{console.error("ResidentAnnouncementsComponent: loadAnnouncements error",n),this.error="Failed to load announcements: "+(n?.message||String(n)),this.loading=!1,this.cdr.markForCheck()}})}filterByCategory(n){this.categoryFilter=n}getFilteredAnnouncements(){return this.categoryFilter==="all"?this.announcements:this.announcements.filter(n=>n.category===this.categoryFilter)}selectAnnouncement(n){this.selectedAnnouncement=n,this.cdr.markForCheck()}closeDetails(){this.selectedAnnouncement=null,this.cdr.markForCheck()}getCategoryIcon(n){switch(n){case"event":return"\u{1F389}";case"alert":return"\u26A0\uFE0F";case"update":return"\u{1F4E2}";default:return"\u{1F4DD}"}}getCategoryLabel(n){switch(n){case"event":return"Event";case"alert":return"Alert";case"update":return"Update";default:return"Other"}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(e){return new(e||c)(f(O),f(B),f(S))};static \u0275cmp=k({type:c,selectors:[["app-resident-announcements"]],decls:14,vars:6,consts:[[1,"max-w-4xl","mx-auto","p-4"],[1,"flex","items-center","gap-4","mb-6"],["pButton","","type","button","icon","pi pi-arrow-left","aria-label","Back",1,"p-button-text","p-0",3,"click"],[1,"text-2xl","font-semibold"],[1,"text-sm","text-gray-600"],["class","mb-4 p-3 bg-red-50 text-red-700 rounded",4,"ngIf"],["class","flex flex-wrap gap-2 mb-4",4,"ngIf"],["class","text-center py-10 text-gray-600",4,"ngIf"],["class","grid md:grid-cols-2 gap-4 mb-6",4,"ngIf"],["class","text-center p-8 bg-white rounded shadow",4,"ngIf"],["class","fixed inset-0 bg-black/50 flex items-center justify-center p-4",3,"click",4,"ngIf"],[1,"mb-4","p-3","bg-red-50","text-red-700","rounded"],[1,"flex","flex-wrap","gap-2","mb-4"],["type","button",3,"click"],[1,"text-center","py-10","text-gray-600"],[1,"grid","md:grid-cols-2","gap-4","mb-6"],["type","button","class","text-left p-4 bg-white rounded shadow cursor-pointer",3,"click",4,"ngFor","ngForOf"],["type","button",1,"text-left","p-4","bg-white","rounded","shadow","cursor-pointer",3,"click"],[1,"text-2xl","mb-2"],[1,"font-semibold","text-lg"],[1,"text-sm","text-gray-600","mt-2"],[1,"flex","items-center","justify-between","mt-3","pt-3","border-t"],[1,"text-xs","uppercase","bg-indigo-600","text-white","px-2","py-1","rounded"],[1,"text-xs","text-gray-500"],[1,"text-center","p-8","bg-white","rounded","shadow"],[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","p-4",3,"click"],["role","dialog","aria-modal","true","aria-labelledby","announcement-title","aria-describedby","announcement-desc",1,"bg-white","rounded-lg","max-w-2xl","w-full","p-6",3,"click"],["type","button","aria-label","Close announcement details",1,"float-right","text-gray-500",3,"click"],[1,"flex","items-center","gap-4","mb-4"],[1,"text-3xl"],["id","announcement-title",1,"text-xl","font-semibold"],["id","announcement-desc",1,"flex","items-center","gap-3","text-sm","text-gray-500","mb-4"],[1,"uppercase","bg-indigo-600","text-white","px-2","py-1","rounded"],[1,"prose","max-w-none"],["class","mt-4 p-3 bg-gray-50 rounded",4,"ngIf"],[1,"mt-4","p-3","bg-gray-50","rounded"],["target","_blank",1,"text-indigo-600",3,"href"]],template:function(e,o){e&1&&(t(0,"div",0)(1,"div",1)(2,"button",2),u("click",function(){return o.goBack()}),i(),t(3,"div")(4,"h2",3),a(5,"Barangay Announcements"),i(),t(6,"p",4),a(7,"Stay updated with the latest news and events"),i()()(),_(8,$,2,1,"div",5)(9,P,9,8,"div",6)(10,L,2,0,"div",7)(11,q,2,1,"div",8)(12,G,2,0,"div",9)(13,J,18,9,"div",10),i()),e&2&&(r(8),m("ngIf",o.error),r(),m("ngIf",!o.loading),r(),m("ngIf",o.loading),r(),m("ngIf",!o.loading&&o.getFilteredAnnouncements().length>0),r(),m("ngIf",!o.loading&&o.getFilteredAnnouncements().length===0),r(),m("ngIf",o.selectedAnnouncement))},dependencies:[T,E,R,j,M,D,F],styles:[".announcements-legacy[_ngcontent-%COMP%]{--fallback: transparent}"]})};export{N as ResidentAnnouncementsComponent};
