import{Aa as f,Ba as k,Ca as h,D as c,Da as w,J as b,K as C,Ka as E,P as _,Pa as T,Qa as q,T as p,Ta as I,U as e,V as t,Va as A,Wa as V,Xa as F,a as x,ba as v,bb as M,da as l,ea as d,f as D,g as S,gb as O,ib as j,jb as B,ma as y,q as u,qa as r,r as m,ra as g,ta as R}from"./chunk-W7V33SUQ.js";import"./chunk-7CGTOI24.js";function P(s,a){s&1&&(e(0,"div",24),r(1,"Welcome"),t())}function $(s,a){if(s&1){let n=v();e(0,"button",29),l("click",function(){u(n);let i=d(3);return m(i.navigateTo("my-requests"))}),e(1,"div",30)(2,"div",31),r(3),t(),e(4,"div",32),r(5),t()(),e(6,"div",33),r(7),f(8,"date"),t()()}if(s&2){let n=a.$implicit,o=d(3);c(3),g(n.documentType),c(),y("color",o.getStatusColor(n.status)),c(),g(o.formatStatus(n.status)),c(2),g(h(8,5,n.requestDate,"short"))}}function N(s,a){if(s&1&&(e(0,"div",27),_(1,$,9,8,"button",28),t()),s&2){let n=d(2);c(),p("ngForOf",n.recentRequests)}}function z(s,a){if(s&1){let n=v();e(0,"div",34)(1,"p"),r(2,"No requests yet. "),e(3,"a",35),l("click",function(){u(n);let i=d(2);return m(i.navigateTo("request-document"))}),r(4,"Create one now"),t()()()}}function L(s,a){if(s&1&&(e(0,"div",15)(1,"h3",16),r(2,"Recent Requests"),t(),_(3,N,2,1,"div",25)(4,z,5,0,"div",26),t()),s&2){let n=d();c(3),p("ngIf",n.recentRequests.length>0),c(),p("ngIf",n.recentRequests.length===0)}}function W(s,a){if(s&1){let n=v();e(0,"button",38),l("click",function(){u(n);let i=d(2);return m(i.navigateTo("announcements"))}),e(1,"div",39)(2,"div")(3,"div",40),r(4),t(),e(5,"div",41),r(6),f(7,"slice"),t()(),e(8,"div",42),r(9),f(10,"date"),t()()()}if(s&2){let n=a.$implicit;c(4),g(n.title),c(2),R("",w(7,4,n.content,0,100),"",n.content&&n.content.length>100?"...":""),c(3),g(h(10,8,n.createdAt,"short"))}}function Q(s,a){if(s&1&&(e(0,"div",36)(1,"h3",16),r(2,"Recent Announcements"),t(),e(3,"div",27),_(4,W,11,11,"button",37),t()()),s&2){let n=d();c(4),p("ngForOf",n.recentAnnouncements)}}function G(s,a){if(s&1){let n=v();e(0,"div",43)(1,"div",44),l("click",function(){u(n);let i=d();return m(i.closeMobileSidebar())}),t(),e(2,"aside",45)(3,"h2",2),r(4,"BIS Resident"),t(),e(5,"nav",46)(6,"button",4),l("click",function(){u(n);let i=d();return i.navigateTo("dashboard"),m(i.closeMobileSidebar())}),r(7,"\u{1F3E0} Dashboard"),t(),e(8,"button",4),l("click",function(){u(n);let i=d();return i.navigateTo("profile"),m(i.closeMobileSidebar())}),r(9,"\u{1F464} Profile"),t(),e(10,"button",4),l("click",function(){u(n);let i=d();return i.navigateTo("request-document"),m(i.closeMobileSidebar())}),r(11,"\u{1F4DD} Request Document"),t(),e(12,"button",4),l("click",function(){u(n);let i=d();return i.navigateTo("my-requests"),m(i.closeMobileSidebar())}),r(13,"\u{1F4CB} My Requests"),t(),e(14,"button",4),l("click",function(){u(n);let i=d();return i.navigateTo("announcements"),m(i.closeMobileSidebar())}),r(15,"\u{1F4E2} Announcements"),t(),e(16,"button",4),l("click",function(){u(n);let i=d();return i.logout(),m(i.closeMobileSidebar())}),r(17,"\u{1F6AA} Logout"),t()()()()}}var U=class s{constructor(a,n,o,i,H){this.authService=a;this.documentRequestService=n;this.announcementService=o;this.router=i;this.cdr=H;this.currentUser$=this.authService.currentUser$}mobileSidebarOpen=!1;currentUser$;recentRequests=[];recentAnnouncements=[];loading=!0;destroy$=new x;ngOnInit(){this.authService.getAuthInitialized().pipe(S(1)).subscribe(()=>{let a=this.authService.currentUserSubject.value;a?.uid?(this.loadRecentRequestsForUser(a.uid),this.loadRecentAnnouncements(),this.router.events.pipe(D(n=>n.constructor.name==="NavigationEnd")).subscribe(()=>{this.loadRecentRequestsForUser(a.uid),this.loadRecentAnnouncements()})):(this.loading=!1,this.cdr.markForCheck())})}loadRecentAnnouncements(){this.announcementService.getActiveAnnouncements().subscribe({next:a=>{this.recentAnnouncements=(a||[]).slice(0,3),this.cdr.markForCheck()},error:a=>{console.error("Failed to load recent announcements",a)}})}toggleMobileSidebar(){this.mobileSidebarOpen=!this.mobileSidebarOpen}closeMobileSidebar(){this.mobileSidebarOpen=!1}loadRecentRequestsForUser(a){this.loading=!0,this.documentRequestService.getRequestsByResidentId(a).subscribe({next:n=>{this.recentRequests=n.sort((o,i)=>new Date(i.requestDate).getTime()-new Date(o.requestDate).getTime()).slice(0,5),this.loading=!1,this.cdr.markForCheck()},error:()=>{this.loading=!1,this.cdr.markForCheck()}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}navigateTo(a){this.router.navigate(["/resident",a])}async logout(){await this.authService.logout(),this.router.navigate(["/login"])}getStatusColor(a){switch(a){case"pending":return"#ffc107";case"approved":return"#28a745";case"ready_for_pickup":return"#17a2b8";case"rejected":return"#dc3545";default:return"#6c757d"}}formatStatus(a){return a.replace(/_/g," ").toUpperCase()}static \u0275fac=function(n){return new(n||s)(b(O),b(j),b(B),b(M),b(E))};static \u0275cmp=C({type:s,selectors:[["app-resident-dashboard"]],decls:54,vars:6,consts:[[1,"min-h-screen","flex","bg-gray-50"],["role","complementary","aria-label","Resident sidebar",1,"w-64","bg-gradient-to-br","from-indigo-600","to-purple-600","text-white","p-6","hidden","md:block"],[1,"text-lg","font-semibold"],["role","navigation","aria-label","Resident navigation",1,"mt-6","space-y-1"],["type","button",1,"w-full","text-left","py-2","px-3","rounded","hover:bg-white/10",3,"click"],[1,"flex-1","p-6"],[1,"flex","items-center","justify-between","mb-6"],[1,"flex","items-center","gap-3"],["type","button","aria-label","Open sidebar",1,"md:hidden","p-2","rounded","bg-gray-100",3,"click"],[1,"text-2xl","font-bold","text-gray-800"],["class","text-indigo-600 font-medium",4,"ngIf"],[1,"space-y-6"],[1,"rounded-lg","p-6","bg-gradient-to-br","from-indigo-600","to-purple-600","text-white","shadow"],[1,"text-2xl","font-semibold"],[1,"opacity-90","mt-2"],[1,"bg-white","rounded-lg","p-6","shadow"],[1,"text-lg","font-semibold","mb-4"],[1,"grid","md:grid-cols-3","gap-4"],["type","button",1,"flex","flex-col","items-center","gap-2","p-4","rounded-lg","bg-indigo-600","text-white","hover:shadow",3,"click"],[1,"text-2xl"],[1,"font-medium"],["class","bg-white rounded-lg p-6 shadow",4,"ngIf"],["class","bg-white rounded-lg p-6 shadow mt-6",4,"ngIf"],["class","fixed inset-0 z-40 md:hidden",4,"ngIf"],[1,"text-indigo-600","font-medium"],["class","space-y-3",4,"ngIf"],["class","text-center text-gray-500",4,"ngIf"],[1,"space-y-3"],["type","button","class","w-full flex justify-between items-center p-3 bg-gray-50 rounded border text-left hover:bg-gray-100",3,"click",4,"ngFor","ngForOf"],["type","button",1,"w-full","flex","justify-between","items-center","p-3","bg-gray-50","rounded","border","text-left","hover:bg-gray-100",3,"click"],[1,"flex","items-center","gap-4"],[1,"font-semibold","text-gray-800","capitalize"],["aria-hidden","true",1,"text-xs","font-semibold","uppercase"],[1,"text-sm","text-gray-500"],[1,"text-center","text-gray-500"],[1,"text-indigo-600","font-medium",3,"click"],[1,"bg-white","rounded-lg","p-6","shadow","mt-6"],["type","button","class","w-full text-left p-3 bg-gray-50 rounded border hover:bg-gray-100",3,"click",4,"ngFor","ngForOf"],["type","button",1,"w-full","text-left","p-3","bg-gray-50","rounded","border","hover:bg-gray-100",3,"click"],[1,"flex","justify-between","items-start"],[1,"font-semibold","text-gray-800"],[1,"text-sm","text-gray-600","mt-1"],[1,"text-xs","text-gray-400","ml-4"],[1,"fixed","inset-0","z-40","md:hidden"],["aria-hidden","true",1,"absolute","inset-0","bg-black/50",3,"click"],[1,"absolute","left-0","top-0","bottom-0","w-64","bg-gradient-to-br","from-indigo-600","to-purple-600","text-white","p-6"],[1,"mt-6","space-y-1"]],template:function(n,o){n&1&&(e(0,"div",0)(1,"aside",1)(2,"h2",2),r(3,"BIS Resident"),t(),e(4,"nav",3)(5,"button",4),l("click",function(){return o.navigateTo("dashboard")}),r(6,"\u{1F3E0} Dashboard"),t(),e(7,"button",4),l("click",function(){return o.navigateTo("profile")}),r(8,"\u{1F464} Profile"),t(),e(9,"button",4),l("click",function(){return o.navigateTo("request-document")}),r(10,"\u{1F4DD} Request Document"),t(),e(11,"button",4),l("click",function(){return o.navigateTo("my-requests")}),r(12,"\u{1F4CB} My Requests"),t(),e(13,"button",4),l("click",function(){return o.navigateTo("announcements")}),r(14,"\u{1F4E2} Announcements"),t(),e(15,"button",4),l("click",function(){return o.logout()}),r(16,"\u{1F6AA} Logout"),t()()(),e(17,"div",5)(18,"header",6)(19,"div",7)(20,"button",8),l("click",function(){return o.toggleMobileSidebar()}),r(21,"\u2630"),t(),e(22,"h1",9),r(23,"Resident Dashboard"),t()(),_(24,P,2,0,"div",10),f(25,"async"),t(),e(26,"section",11)(27,"div",12)(28,"h2",13),r(29,"Welcome Back!"),t(),e(30,"p",14),r(31,"Manage your document requests and stay updated with barangay announcements."),t()(),e(32,"div",15)(33,"h3",16),r(34,"Quick Actions"),t(),e(35,"div",17)(36,"button",18),l("click",function(){return o.navigateTo("request-document")}),e(37,"span",19),r(38,"\u{1F4DD}"),t(),e(39,"span",20),r(40,"Request Document"),t()(),e(41,"button",18),l("click",function(){return o.navigateTo("my-requests")}),e(42,"span",19),r(43,"\u{1F4CB}"),t(),e(44,"span",20),r(45,"Check Requests"),t()(),e(46,"button",18),l("click",function(){return o.navigateTo("announcements")}),e(47,"span",19),r(48,"\u{1F4E2}"),t(),e(49,"span",20),r(50,"View Announcements"),t()()()(),_(51,L,5,2,"div",21)(52,Q,5,1,"div",22),t()(),_(53,G,18,0,"div",23),t()),n&2&&(c(24),p("ngIf",k(25,4,o.currentUser$)),c(27),p("ngIf",!o.loading),c(),p("ngIf",o.recentAnnouncements.length>0),c(),p("ngIf",o.mobileSidebarOpen))},dependencies:[F,T,q,I,V,A],styles:[".resident-legacy[_ngcontent-%COMP%]{--fallback: transparent}"]})};export{U as ResidentDashboardComponent};
