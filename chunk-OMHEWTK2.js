import{b as T,c as D,d as N,e as O,f as F,g as A,h as L,i as j,j as q,l as z}from"./chunk-5TDXQA3R.js";import{a as U,b as H}from"./chunk-6IJTW5S2.js";import{D as l,J as x,K as M,Ka as W,P,Qa as B,T as h,U as i,V as n,W as E,Xa as R,ba as k,bb as V,da as C,ea as m,g as _,gb as I,h as w,hb as G,q as p,qa as r,r as c,ra as y,ua as u,va as g,wa as f}from"./chunk-SW3RDXTT.js";import{a as b,b as S}from"./chunk-7CGTOI24.js";function J(a,s){a&1&&(i(0,"div",8),r(1,"Loading profile..."),n())}function K(a,s){if(a&1&&(i(0,"div",9),r(1),n()),a&2){let e=m();l(),y(e.error)}}function Q(a,s){if(a&1&&(i(0,"div",10),r(1),n()),a&2){let e=m();l(),y(e.success)}}function X(a,s){if(a&1){let e=k();i(0,"form",11),C("ngSubmit",function(){p(e);let t=m();return c(t.save())}),i(1,"div")(2,"label",12),r(3,"Full name"),n(),i(4,"input",13),f("ngModelChange",function(t){p(e);let o=m();return g(o.resident.name,t)||(o.resident.name=t),c(t)}),n()(),i(5,"div")(6,"label",12),r(7,"Email"),n(),E(8,"input",14),n(),i(9,"div",15)(10,"div")(11,"label",12),r(12,"Phone"),n(),i(13,"input",16),f("ngModelChange",function(t){p(e);let o=m();return g(o.resident.phone,t)||(o.resident.phone=t),c(t)}),n()(),i(14,"div")(15,"label",12),r(16,"Barangay"),n(),i(17,"input",17),f("ngModelChange",function(t){p(e);let o=m();return g(o.resident.barangay,t)||(o.resident.barangay=t),c(t)}),n()()(),i(18,"div")(19,"label",12),r(20,"Address"),n(),i(21,"input",18),f("ngModelChange",function(t){p(e);let o=m();return g(o.resident.address,t)||(o.resident.address=t),c(t)}),n()(),i(22,"div",19)(23,"div")(24,"label",12),r(25,"Gender"),n(),i(26,"select",20),f("ngModelChange",function(t){p(e);let o=m();return g(o.resident.gender,t)||(o.resident.gender=t),c(t)}),i(27,"option",21),r(28,"Male"),n(),i(29,"option",22),r(30,"Female"),n(),i(31,"option",23),r(32,"Other"),n()()(),i(33,"div")(34,"label",12),r(35,"Civil status"),n(),i(36,"select",24),f("ngModelChange",function(t){p(e);let o=m();return g(o.resident.civilStatus,t)||(o.resident.civilStatus=t),c(t)}),i(37,"option",25),r(38,"Single"),n(),i(39,"option",26),r(40,"Married"),n(),i(41,"option",27),r(42,"Widowed"),n(),i(43,"option",28),r(44,"Divorced"),n()()(),i(45,"div")(46,"label",12),r(47,"Date of birth"),n(),i(48,"input",29),f("ngModelChange",function(t){p(e);let o=m();return g(o.resident.dateOfBirth,t)||(o.resident.dateOfBirth=t),c(t)}),n()()(),i(49,"div")(50,"label",12),r(51,"Occupation"),n(),i(52,"input",30),f("ngModelChange",function(t){p(e);let o=m();return g(o.resident.occupation,t)||(o.resident.occupation=t),c(t)}),n()(),i(53,"div",31)(54,"button",32),r(55),n(),i(56,"button",33),C("click",function(){p(e);let t=m();return c(t.goBack())}),r(57,"Cancel"),n()()()}if(a&2){let e=m();l(4),u("ngModel",e.resident.name),l(4),h("value",e.resident.email),l(5),u("ngModel",e.resident.phone),l(4),u("ngModel",e.resident.barangay),l(4),u("ngModel",e.resident.address),l(5),u("ngModel",e.resident.gender),l(10),u("ngModel",e.resident.civilStatus),l(12),u("ngModel",e.resident.dateOfBirth),l(4),u("ngModel",e.resident.occupation),l(2),h("disabled",e.saving),l(),y(e.saving?"Saving...":"Save Changes")}}var v=class a{constructor(s,e,d,t){this.residentService=s;this.authService=e;this.router=d;this.cdr=t}resident={};loading=!0;saving=!1;error="";success="";ngOnInit(){this.authService.getAuthInitialized().pipe(_(1),w(()=>this.authService.getCurrentUser().pipe(_(1)))).subscribe({next:s=>{console.log("ProfileComponent: auth initialized, current user =",s?.uid||null),s&&s.uid?this.residentService.getResidentById(s.uid).pipe(_(1)).subscribe({next:e=>{console.log("ProfileComponent: resident fetch result =",e),e?this.resident=e:this.error="Resident profile not found.",this.loading=!1,this.cdr.markForCheck()},error:e=>{console.error("ProfileComponent: failed to load resident",e),this.error="Failed to load profile.",this.loading=!1,this.cdr.markForCheck()}}):(this.error="No authenticated user.",this.loading=!1,this.cdr.markForCheck())},error:s=>{console.error("ProfileComponent: auth initialization error",s),this.error="Authentication initialization failed.",this.loading=!1,this.cdr.markForCheck()}})}save(){if(this.error="",this.success="",!this.resident?.id){this.error="No resident id.";return}this.saving=!0;let s;if(this.resident.dateOfBirth){let d=new Date(this.resident.dateOfBirth);isNaN(d.getTime())||(s=d)}let e=S(b({name:this.resident.name||"",phone:this.resident.phone||"",address:this.resident.address||"",barangay:this.resident.barangay||"",occupation:this.resident.occupation||"",civilStatus:this.resident.civilStatus,gender:this.resident.gender},s?{dateOfBirth:s}:{}),{updatedAt:new Date});this.residentService.updateResident(this.resident.id,e).pipe(_(1)).subscribe(()=>{this.saving=!1,this.success="Profile updated successfully."},d=>{this.saving=!1,this.error="Failed to update profile."})}goBack(){this.router.navigate(["/resident"])}static \u0275fac=function(e){return new(e||a)(x(G),x(I),x(V),x(W))};static \u0275cmp=M({type:a,selectors:[["ng-component"]],decls:9,vars:4,consts:[[1,"max-w-3xl","mx-auto","p-6"],[1,"flex","items-center","gap-4","mb-6"],["pButton","","type","button","icon","pi pi-arrow-left","aria-label","Back",1,"p-button-text","p-0",3,"click"],[1,"text-2xl","font-semibold"],["class","text-gray-600",4,"ngIf"],["class","bg-red-50 text-red-700 p-3 rounded mb-4",4,"ngIf"],["class","bg-green-50 text-green-700 p-3 rounded mb-4",4,"ngIf"],["class","bg-white p-6 rounded shadow space-y-4",3,"ngSubmit",4,"ngIf"],[1,"text-gray-600"],[1,"bg-red-50","text-red-700","p-3","rounded","mb-4"],[1,"bg-green-50","text-green-700","p-3","rounded","mb-4"],[1,"bg-white","p-6","rounded","shadow","space-y-4",3,"ngSubmit"],[1,"block","text-sm","font-medium","text-gray-700"],["name","name",1,"mt-1","block","w-full","border","rounded","px-3","py-2",3,"ngModelChange","ngModel"],["readonly","",1,"mt-1","block","w-full","border","rounded","px-3","py-2","bg-gray-100",3,"value"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["name","phone",1,"mt-1","block","w-full","border","rounded","px-3","py-2",3,"ngModelChange","ngModel"],["name","barangay",1,"mt-1","block","w-full","border","rounded","px-3","py-2",3,"ngModelChange","ngModel"],["name","address",1,"mt-1","block","w-full","border","rounded","px-3","py-2",3,"ngModelChange","ngModel"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],["name","gender",1,"mt-1","block","w-full","border","rounded","px-3","py-2",3,"ngModelChange","ngModel"],["value","male"],["value","female"],["value","other"],["name","civilStatus",1,"mt-1","block","w-full","border","rounded","px-3","py-2",3,"ngModelChange","ngModel"],["value","single"],["value","married"],["value","widowed"],["value","divorced"],["name","dateOfBirth","type","date",1,"mt-1","block","w-full","border","rounded","px-3","py-2",3,"ngModelChange","ngModel"],["name","occupation",1,"mt-1","block","w-full","border","rounded","px-3","py-2",3,"ngModelChange","ngModel"],[1,"flex","items-center","gap-3"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded",3,"disabled"],["type","button",1,"px-4","py-2","border","rounded",3,"click"]],template:function(e,d){e&1&&(i(0,"div",0)(1,"div",1)(2,"button",2),C("click",function(){return d.goBack()}),n(),i(3,"h2",3),r(4,"My Profile"),n()(),P(5,J,2,0,"div",4)(6,K,2,1,"div",5)(7,Q,2,1,"div",6)(8,X,58,11,"form",7),n()),e&2&&(l(5),h("ngIf",d.loading),l(),h("ngIf",d.error),l(),h("ngIf",d.success),l(),h("ngIf",!d.loading&&!d.error))},dependencies:[R,B,z,A,j,q,T,L,D,N,F,O,H,U],styles:["[_nghost-%COMP%]{display:block}"]})};var pe=[{path:"dashboard",loadComponent:()=>import("./chunk-4OQCVFOL.js").then(a=>a.ResidentDashboardComponent)},{path:"request-document",loadComponent:()=>import("./chunk-KICZNQZA.js").then(a=>a.RequestDocumentComponent)},{path:"profile",loadComponent:()=>Promise.resolve(v)},{path:"my-requests",loadComponent:()=>import("./chunk-DPDPDQAJ.js").then(a=>a.MyRequestsComponent)},{path:"announcements",loadComponent:()=>import("./chunk-NVPRM3PX.js").then(a=>a.ResidentAnnouncementsComponent)},{path:"",redirectTo:"dashboard",pathMatch:"full"}];export{pe as RESIDENT_ROUTES};
