import{b as P,c as W,f as q,h as F,i as O,j,l as B}from"./chunk-CLZ4E3QE.js";import{b as U}from"./chunk-SDEG5XVJ.js";import{Aa as k,Ba as E,D as o,J as S,K as y,Ka as R,P as g,Qa as T,T as _,Ta as M,U as i,V as n,Xa as I,a as w,ba as v,bb as V,da as c,ea as l,f as C,g as D,gb as A,hb as L,ib as N,kb as z,q as f,qa as r,r as m,ra as u,ua as x,va as b,wa as h}from"./chunk-W7V33SUQ.js";import"./chunk-7CGTOI24.js";function Y(d,s){d&1&&(i(0,"span"),r(1,"Welcome"),n())}function G(d,s){d&1&&(i(0,"div",18),r(1,"Loading dashboard data..."),n())}function H(d,s){if(d&1&&(i(0,"div",19),r(1),n()),d&2){let t=l();o(),u(t.error)}}function J(d,s){if(d&1){let t=v();i(0,"div",20)(1,"div",21)(2,"div",22)(3,"h2",3),r(4,"Quick Actions"),n(),i(5,"button",23),c("click",function(){f(t);let e=l();return m(e.openAddStaff())}),r(6,"Add Staff"),n()(),i(7,"div",24)(8,"button",25),c("click",function(){f(t);let e=l();return m(e.navigateTo("residents"))}),r(9,"Add/Manage Residents"),n(),i(10,"button",25),c("click",function(){f(t);let e=l();return m(e.navigateTo("requests"))}),r(11,"Review Requests"),n(),i(12,"button",25),c("click",function(){f(t);let e=l();return m(e.navigateTo("announcements"))}),r(13,"Post Announcement"),n(),i(14,"button",25),c("click",function(){f(t);let e=l();return m(e.navigateTo("reports"))}),r(15,"View Full Reports"),n()()(),i(16,"div",26)(17,"div",27)(18,"h3",28),r(19,"Total Residents"),n(),i(20,"p",29),r(21),n()(),i(22,"div",27)(23,"h3",28),r(24,"Male"),n(),i(25,"p",29),r(26),n()(),i(27,"div",27)(28,"h3",28),r(29,"Female"),n(),i(30,"p",29),r(31),n()(),i(32,"div",27)(33,"h3",28),r(34,"Pending Requests"),n(),i(35,"p",30),r(36),n()(),i(37,"div",27)(38,"h3",28),r(39,"Approved Requests"),n(),i(40,"p",31),r(41),n()(),i(42,"div",27)(43,"h3",28),r(44,"Ready for Pickup"),n(),i(45,"p",32),r(46),n()(),i(47,"div",27)(48,"h3",28),r(49,"Total Issued"),n(),i(50,"p",29),r(51),n()(),i(52,"div",27)(53,"h3",28),r(54,"Barangay Clearance"),n(),i(55,"p",29),r(56),n()()()()}if(d&2){let t=l();o(21),u((t.residentReport==null?null:t.residentReport.totalResidents)||0),o(5),u((t.residentReport==null?null:t.residentReport.totalMale)||0),o(5),u((t.residentReport==null?null:t.residentReport.totalFemale)||0),o(5),u((t.documentReport==null?null:t.documentReport.pendingRequests)||0),o(5),u((t.documentReport==null?null:t.documentReport.approvedRequests)||0),o(5),u((t.documentReport==null?null:t.documentReport.readyForPickup)||0),o(5),u((t.documentReport==null?null:t.documentReport.totalDocumentsIssued)||0),o(5),u((t.documentReport==null?null:t.documentReport.barangayClearance)||0)}}function K(d,s){if(d&1){let t=v();i(0,"div",33)(1,"div",34),c("click",function(){f(t);let e=l();return m(e.closeMobileSidebar())}),n(),i(2,"aside",35)(3,"div",2)(4,"h2",3),r(5,"BIS Staff"),n()(),i(6,"nav",4)(7,"button",36),c("click",function(){f(t);let e=l();return e.navigateTo("dashboard"),m(e.closeMobileSidebar())}),r(8,"\u{1F4CA} Dashboard"),n(),i(9,"button",36),c("click",function(){f(t);let e=l();return e.navigateTo("residents"),m(e.closeMobileSidebar())}),r(10,"\u{1F465} Residents"),n(),i(11,"button",36),c("click",function(){f(t);let e=l();return e.navigateTo("requests"),m(e.closeMobileSidebar())}),r(12,"\u{1F4CB} Document Requests"),n(),i(13,"button",36),c("click",function(){f(t);let e=l();return e.navigateTo("announcements"),m(e.closeMobileSidebar())}),r(14,"\u{1F4E2} Announcements"),n(),i(15,"button",36),c("click",function(){f(t);let e=l();return e.navigateTo("reports"),m(e.closeMobileSidebar())}),r(16,"\u{1F4C8} Reports"),n(),i(17,"button",36),c("click",function(){f(t);let e=l();return e.logout(),m(e.closeMobileSidebar())}),r(18,"\u{1F6AA} Logout"),n()()()()}}function X(d,s){if(d&1&&(i(0,"div",54),r(1),n()),d&2){let t=l(2);o(),u(t.error)}}function Z(d,s){d&1&&(i(0,"div",11),r(1,"Creating staff account..."),n())}function $(d,s){if(d&1&&(i(0,"div",55),r(1),n()),d&2){let t=l(2);o(),u(t.createStaffSuccess)}}function ee(d,s){if(d&1){let t=v();i(0,"div",37)(1,"div",38)(2,"h3",39),r(3,"Add Staff"),n(),g(4,X,2,1,"div",40),i(5,"div",41)(6,"input",42),h("ngModelChange",function(e){f(t);let p=l();return b(p.newStaff.name,e)||(p.newStaff.name=e),m(e)}),n(),i(7,"input",43),h("ngModelChange",function(e){f(t);let p=l();return b(p.newStaff.email,e)||(p.newStaff.email=e),m(e)}),n(),i(8,"input",44),h("ngModelChange",function(e){f(t);let p=l();return b(p.newStaff.password,e)||(p.newStaff.password=e),m(e)}),n(),i(9,"select",45),h("ngModelChange",function(e){f(t);let p=l();return b(p.newStaff.role,e)||(p.newStaff.role=e),m(e)}),i(10,"option",46),r(11,"Staff"),n(),i(12,"option",47),r(13,"Admin"),n()(),i(14,"input",48),h("ngModelChange",function(e){f(t);let p=l();return b(p.newStaff.adminPassword,e)||(p.newStaff.adminPassword=e),m(e)}),n(),g(15,Z,2,0,"div",49)(16,$,2,1,"div",50),i(17,"div",51)(18,"button",52),c("click",function(){f(t);let e=l();return m(e.createStaff())}),r(19,"Create"),n(),i(20,"button",53),c("click",function(){f(t);let e=l();return m(e.closeAddStaff())}),r(21,"Cancel"),n()()()()()}if(d&2){let t=l();o(4),_("ngIf",t.error),o(2),x("ngModel",t.newStaff.name),o(),x("ngModel",t.newStaff.email),o(),x("ngModel",t.newStaff.password),o(),x("ngModel",t.newStaff.role),o(5),x("ngModel",t.newStaff.adminPassword),o(),_("ngIf",t.createStaffLoading),o(),_("ngIf",t.createStaffSuccess)}}var Q=class d{constructor(s,t,a,e,p,te){this.authService=s;this.residentService=t;this.documentRequestService=a;this.reportService=e;this.router=p;this.cdr=te;this.currentUser$=this.authService.currentUser$}mobileSidebarOpen=!1;currentUser$;residentReport=null;documentReport=null;loading=!0;error="";showAddStaffModal=!1;newStaff={name:"",email:"",password:"",role:"staff",adminPassword:""};createStaffLoading=!1;createStaffSuccess="";destroy$=new w;ngOnInit(){this.authService.getAuthInitialized().pipe(D(1)).subscribe(()=>{this.loadDashboardData(),this.router.events.pipe(C(s=>s.constructor.name==="NavigationEnd")).subscribe(()=>this.loadDashboardData())})}loadDashboardData(){this.loading=!0,this.reportService.getResidentStatistics().subscribe({next:s=>{this.residentReport=s,this.cdr.markForCheck()},error:s=>{this.error="Failed to load resident statistics",this.cdr.markForCheck()}}),this.reportService.getDocumentStatistics().subscribe({next:s=>{this.documentReport=s,this.loading=!1,this.cdr.markForCheck()},error:s=>{this.error="Failed to load document statistics",this.loading=!1,this.cdr.markForCheck()}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}navigateTo(s){this.router.navigate(["/staff",s])}toggleMobileSidebar(){this.mobileSidebarOpen=!this.mobileSidebarOpen}closeMobileSidebar(){this.mobileSidebarOpen=!1}openAddStaff(){this.showAddStaffModal=!0}closeAddStaff(){this.showAddStaffModal=!1,this.newStaff={name:"",email:"",password:"",role:"staff"}}async createStaff(){if(this.error="",this.createStaffSuccess="",!this.newStaff.email||!this.newStaff.password||!this.newStaff.name){this.error="Please provide name, email and password";return}if(!this.newStaff.adminPassword){this.error="Please enter your password to confirm staff creation (for re-authentication).";return}this.createStaffLoading=!0;try{await this.authService.createStaffAsAdmin(this.newStaff.email,this.newStaff.password,this.newStaff.name,this.newStaff.role,this.newStaff.adminPassword||""),this.createStaffSuccess="Staff account created successfully.",this.closeAddStaff(),this.loadDashboardData()}catch(s){console.error("Failed to create staff:",s),this.error=s?.message||"Failed to create staff"}finally{this.createStaffLoading=!1}}async logout(){await this.authService.logout(),this.router.navigate(["/login"])}static \u0275fac=function(t){return new(t||d)(S(A),S(L),S(N),S(z),S(V),S(R))};static \u0275cmp=y({type:d,selectors:[["app-staff-dashboard"]],decls:33,vars:8,consts:[[1,"min-h-screen","flex","bg-gray-50"],[1,"w-64","bg-gradient-to-br","from-indigo-500","to-purple-600","text-white","p-6","hidden","md:block"],[1,"mb-8"],[1,"text-lg","font-semibold"],[1,"space-y-1"],[1,"block","px-3","py-2","rounded","hover:bg-white/20","cursor-pointer",3,"click"],[1,"flex-1","p-6"],[1,"flex","items-center","justify-between","mb-6"],[1,"flex","items-center","gap-3"],["type","button","aria-label","Open sidebar",1,"md:hidden","p-2","rounded","bg-gray-100",3,"click"],[1,"text-2xl","font-bold","text-gray-800"],[1,"text-sm","text-gray-600"],[4,"ngIf"],["class","rounded bg-white p-6 shadow",4,"ngIf"],["class","mb-4 p-4 bg-red-50 text-red-700 rounded",4,"ngIf"],["class","space-y-6",4,"ngIf"],["class","fixed inset-0 z-40 md:hidden",4,"ngIf"],["class","fixed inset-0 bg-black/50 flex items-center justify-center z-50",4,"ngIf"],[1,"rounded","bg-white","p-6","shadow"],[1,"mb-4","p-4","bg-red-50","text-red-700","rounded"],[1,"space-y-6"],[1,"bg-white","p-4","rounded","shadow","order-1","md:order-2"],[1,"flex","items-center","justify-between","mb-3"],[1,"bg-indigo-600","text-white","px-3","py-1","rounded",3,"click"],[1,"flex","flex-wrap","gap-2"],[1,"px-3","py-2","bg-indigo-100","text-indigo-700","rounded",3,"click"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-4","gap-4","order-2","md:order-1"],[1,"bg-white","p-4","rounded","shadow","text-center"],[1,"text-xs","font-semibold","text-gray-500","uppercase"],[1,"text-3xl","font-bold","text-indigo-600"],[1,"text-3xl","font-bold","text-red-500"],[1,"text-3xl","font-bold","text-green-600"],[1,"text-3xl","font-bold","text-teal-500"],[1,"fixed","inset-0","z-40","md:hidden"],["aria-hidden","true",1,"absolute","inset-0","bg-black/50",3,"click"],[1,"absolute","left-0","top-0","bottom-0","w-64","bg-gradient-to-br","from-indigo-500","to-purple-600","text-white","p-6"],["type","button",1,"w-full","text-left","px-3","py-2","rounded","hover:bg-white/20",3,"click"],[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50"],[1,"bg-white","rounded-lg","w-full","max-w-md","p-6"],[1,"text-lg","font-semibold","mb-3"],["class","mb-3 p-2 bg-red-50 text-red-700 rounded",4,"ngIf"],[1,"grid","gap-3"],["type","text","placeholder","Name",1,"w-full","rounded","border-gray-200","p-2",3,"ngModelChange","ngModel"],["type","email","placeholder","Email",1,"w-full","rounded","border-gray-200","p-2",3,"ngModelChange","ngModel"],["type","password","placeholder","Password",1,"w-full","rounded","border-gray-200","p-2",3,"ngModelChange","ngModel"],[1,"w-full","rounded","border-gray-200","p-2",3,"ngModelChange","ngModel"],["value","staff"],["value","admin"],["type","password","placeholder","Your password (confirm)",1,"w-full","rounded","border-gray-200","p-2",3,"ngModelChange","ngModel"],["class","text-sm text-gray-600",4,"ngIf"],["class","text-sm text-green-600",4,"ngIf"],[1,"flex","justify-end","gap-2","mt-2"],[1,"px-3","py-2","bg-indigo-600","text-white","rounded",3,"click"],[1,"px-3","py-2","bg-gray-200","rounded",3,"click"],[1,"mb-3","p-2","bg-red-50","text-red-700","rounded"],[1,"text-sm","text-green-600"]],template:function(t,a){t&1&&(i(0,"div",0)(1,"aside",1)(2,"div",2)(3,"h2",3),r(4,"BIS Staff"),n()(),i(5,"nav",4)(6,"a",5),c("click",function(){return a.navigateTo("dashboard")}),r(7,"\u{1F4CA} Dashboard"),n(),i(8,"a",5),c("click",function(){return a.navigateTo("residents")}),r(9,"\u{1F465} Residents"),n(),i(10,"a",5),c("click",function(){return a.navigateTo("requests")}),r(11,"\u{1F4CB} Document Requests"),n(),i(12,"a",5),c("click",function(){return a.navigateTo("announcements")}),r(13,"\u{1F4E2} Announcements"),n(),i(14,"a",5),c("click",function(){return a.navigateTo("reports")}),r(15,"\u{1F4C8} Reports"),n(),i(16,"a",5),c("click",function(){return a.logout()}),r(17,"\u{1F6AA} Logout"),n()()(),i(18,"div",6)(19,"header",7)(20,"div",8)(21,"button",9),c("click",function(){return a.toggleMobileSidebar()}),r(22,"\u2630"),n(),i(23,"h1",10),r(24,"Staff Dashboard"),n()(),i(25,"div",11),g(26,Y,2,0,"span",12),k(27,"async"),n()(),g(28,G,2,0,"div",13)(29,H,2,1,"div",14)(30,J,57,8,"div",15),n()(),g(31,K,19,0,"div",16)(32,ee,22,8,"div",17)),t&2&&(o(26),_("ngIf",E(27,6,a.currentUser$)),o(2),_("ngIf",a.loading),o(),_("ngIf",a.error),o(),_("ngIf",!a.loading&&!a.error),o(),_("ngIf",a.mobileSidebarOpen),o(),_("ngIf",a.showAddStaffModal))},dependencies:[I,T,B,O,j,P,F,W,q,U,M],styles:[".staff-dashboard-legacy-fallback[_ngcontent-%COMP%]{--fallback-bg: transparent}"]})};export{Q as StaffDashboardComponent};
