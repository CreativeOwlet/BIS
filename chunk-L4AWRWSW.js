import{c as H,f as W,h as Y,i as z,j as K,l as G}from"./chunk-4B3NDEDS.js";import{a as Q,b as X}from"./chunk-QT4DXLEV.js";import{Aa as p,Ba as b,C as w,Ca as m,D as r,J as y,K as E,Ka as F,Oa as j,P as v,Pa as B,Qa as P,T as d,U as t,Ua as O,V as i,Va as A,W as k,Xa as N,a as h,ba as q,bb as V,cb as U,da as x,ea as l,eb as L,g as S,gb as $,h as C,i as I,ib as J,q as g,qa as s,r as _,ra as c,sa as R,ua as D,va as M,wa as T}from"./chunk-EGHJCYB6.js";import"./chunk-7CGTOI24.js";function ee(n,a){if(n&1&&(t(0,"div",19),s(1),i()),n&2){let e=l();r(),c(e.error)}}function te(n,a){n&1&&(t(0,"div",20),s(1,"Loading your requests..."),i())}function ie(n,a){if(n&1&&(t(0,"div"),s(1),p(2,"date"),i()),n&2){let e=l().$implicit;r(),R("Approved: ",m(2,1,e.approvedDate,"short"))}}function ne(n,a){if(n&1){let e=q();t(0,"button",23),x("click",function(){let u=g(e).$implicit,f=l(2);return _(f.selectRequest(u))}),t(1,"div",24)(2,"div",25),s(3),i(),t(4,"div",26)(5,"div",27)(6,"h3",28),s(7),p(8,"titlecase"),i(),t(9,"span",29),s(10),i()(),t(11,"p",30),s(12),i(),t(13,"div",31)(14,"div"),s(15),p(16,"date"),i(),v(17,ie,3,4,"div",32),i()(),t(18,"div",33),s(19,"\u203A"),i()()()}if(n&2){let e=a.$implicit,o=l(2);r(2),d("ngClass",o.getStatusBadgeClass(e.status)),r(),c(o.getStatusIcon(e.status)),r(4),c(b(8,8,e.documentType)),r(2),d("ngClass",o.getStatusBadgeClass(e.status)),r(),c(o.formatStatus(e.status)),r(2),c(e.purpose),r(3),R("Requested: ",m(16,10,e.requestDate,"short")),r(2),d("ngIf",e.approvedDate)}}function se(n,a){if(n&1&&(t(0,"div",21),v(1,ne,20,13,"button",22),i()),n&2){let e=l();r(),d("ngForOf",e.filteredRequests)}}function re(n,a){n&1&&(t(0,"div",34)(1,"p",35),s(2,"No requests found"),i(),t(3,"a",36),s(4,"Create a new request"),i()())}function ae(n,a){if(n&1&&(t(0,"div",42)(1,"strong"),s(2,"Approved Date:"),i(),t(3,"span"),s(4),p(5,"date"),i()()),n&2){let e=l(2);r(4),c(m(5,1,e.selectedRequest.approvedDate,"medium"))}}function oe(n,a){if(n&1&&(t(0,"div",42)(1,"strong"),s(2,"Ready for Pickup Date:"),i(),t(3,"span"),s(4),p(5,"date"),i()()),n&2){let e=l(2);r(4),c(m(5,1,e.selectedRequest.readyDate,"medium"))}}function de(n,a){if(n&1&&(t(0,"div",42)(1,"strong"),s(2,"Completed Date:"),i(),t(3,"span"),s(4),p(5,"date"),i()()),n&2){let e=l(2);r(4),c(m(5,1,e.selectedRequest.completedDate,"medium"))}}function le(n,a){if(n&1&&(t(0,"div",54)(1,"strong"),s(2,"Uploaded ID:"),i(),t(3,"div",55),k(4,"img",56),i()()),n&2){let e=l(2);r(4),d("src",e.selectedRequest.attachmentUrl,w)}}function ce(n,a){if(n&1&&(t(0,"div",42)(1,"strong"),s(2,"Ready for Pickup Date:"),i(),t(3,"span"),s(4),p(5,"date"),i()()),n&2){let e=l(2);r(4),c(m(5,1,e.selectedRequest.readyDate,"medium"))}}function ue(n,a){if(n&1&&(t(0,"div",57)(1,"strong"),s(2,"Staff Remarks:"),i(),t(3,"div",58),s(4),i()()),n&2){let e=l(2);r(4),c(e.selectedRequest.remarks)}}function pe(n,a){if(n&1&&(t(0,"div",59)(1,"strong"),s(2,"Revision Reason:"),i(),t(3,"div",60),s(4),i()()),n&2){let e=l(2);r(4),c(e.selectedRequest.revisionReason)}}function me(n,a){if(n&1&&(t(0,"div",61)(1,"strong"),s(2,"Rejection Reason:"),i(),t(3,"div",58),s(4),i()()),n&2){let e=l(2);r(4),c(e.selectedRequest.rejectionReason)}}function ve(n,a){n&1&&(t(0,"div",62),s(1,"\u2713 Your document is ready for pickup at the barangay office."),i())}function xe(n,a){n&1&&(t(0,"div",63),s(1,"\u23F3 Your request is being reviewed. Please check back soon."),i())}function fe(n,a){n&1&&(t(0,"div",64),s(1,"\u2705 This request has been completed. Thank you!"),i())}function ge(n,a){n&1&&(t(0,"div",65),s(1,"\u{1F504} This request needs revision. Please review the reason above and contact the barangay office."),i())}function _e(n,a){n&1&&(t(0,"div",66),s(1,"Your request has been rejected. Please contact the barangay office for more information."),i())}function ye(n,a){if(n&1){let e=q();t(0,"div",37),x("click",function(){g(e);let u=l();return _(u.closeDetails())}),t(1,"div",38),x("click",function(u){return g(e),_(u.stopPropagation())}),t(2,"button",39),x("click",function(){g(e);let u=l();return _(u.closeDetails())}),s(3,"\u2715"),i(),t(4,"h3",40),s(5,"Request Details"),i(),t(6,"div",41)(7,"div",42)(8,"strong"),s(9,"Document Type:"),i(),t(10,"span"),s(11),p(12,"titlecase"),i()(),t(13,"div",42)(14,"strong"),s(15,"Status:"),i(),t(16,"span",43),s(17),i()(),t(18,"div",42)(19,"strong"),s(20,"Purpose:"),i(),t(21,"span"),s(22),i()(),t(23,"div",42)(24,"strong"),s(25,"Requested Date:"),i(),t(26,"span"),s(27),p(28,"date"),i()(),v(29,ae,6,4,"div",44)(30,oe,6,4,"div",44)(31,de,6,4,"div",44)(32,le,5,1,"div",45)(33,ce,6,4,"div",44)(34,ue,5,1,"div",46)(35,pe,5,1,"div",47)(36,me,5,1,"div",48),i(),v(37,ve,2,0,"div",49)(38,xe,2,0,"div",50)(39,fe,2,0,"div",51)(40,ge,2,0,"div",52)(41,_e,2,0,"div",53),i()()}if(n&2){let e=l();r(11),c(b(12,18,e.selectedRequest.documentType)),r(5),d("ngClass",e.getStatusBadgeClass(e.selectedRequest.status)),r(),c(e.formatStatus(e.selectedRequest.status)),r(5),c(e.selectedRequest.purpose),r(5),c(m(28,20,e.selectedRequest.requestDate,"medium")),r(2),d("ngIf",e.selectedRequest.approvedDate),r(),d("ngIf",e.selectedRequest.readyDate),r(),d("ngIf",e.selectedRequest.completedDate),r(),d("ngIf",e.selectedRequest.attachmentUrl),r(),d("ngIf",e.selectedRequest.readyDate),r(),d("ngIf",e.selectedRequest.remarks),r(),d("ngIf",e.selectedRequest.revisionReason),r(),d("ngIf",e.selectedRequest.rejectionReason),r(),d("ngIf",e.selectedRequest.status==="ready_for_pickup"),r(),d("ngIf",e.selectedRequest.status==="pending"),r(),d("ngIf",e.selectedRequest.status==="completed"),r(),d("ngIf",e.selectedRequest.status==="needs_revision"),r(),d("ngIf",e.selectedRequest.status==="rejected")}}var Z=class n{constructor(a,e,o,u){this.documentRequestService=a;this.authService=e;this.router=o;this.cdr=u}requests=[];filteredRequests=[];loading=!0;error="";statusFilter="all";selectedRequest=null;destroy$=new h;escHandler=a=>{a.key==="Escape"&&this.selectedRequest&&(this.closeDetails(),this.cdr.markForCheck())};ngOnInit(){window.addEventListener("keydown",this.escHandler),this.authService.getAuthInitialized().pipe(S(1),C(()=>this.documentRequestService.getAllRequests()),I(this.destroy$)).subscribe({next:a=>{let e=this.authService.currentUserSubject.value;e?.uid&&(this.requests=a.filter(o=>o.residentId===e.uid).sort((o,u)=>new Date(u.requestDate).getTime()-new Date(o.requestDate).getTime()),this.filterRequests()),this.loading=!1,this.cdr.markForCheck()},error:a=>{this.error="Failed to load requests",this.loading=!1,this.cdr.markForCheck()}})}filterRequests(){this.statusFilter==="all"?this.filteredRequests=this.requests:this.filteredRequests=this.requests.filter(a=>a.status===this.statusFilter)}selectRequest(a){this.selectedRequest=a,setTimeout(()=>{document.querySelector("#request-details-close")?.focus(),this.cdr.markForCheck()},0)}closeDetails(){this.selectedRequest=null}goBack(){this.router.navigate(["/resident"])}getStatusBadgeClass(a){switch(a){case"pending":return"bg-yellow-400 text-black";case"approved":return"bg-green-500 text-white";case"ready_for_pickup":return"bg-teal-500 text-white";case"rejected":return"bg-red-500 text-white";case"completed":return"bg-blue-600 text-white";case"needs_revision":return"bg-orange-500 text-white";default:return"bg-gray-500 text-white"}}formatStatus(a){return a.replace(/_/g," ").toUpperCase()}getStatusIcon(a){switch(a){case"pending":return"\u23F3";case"approved":return"\u2713";case"ready_for_pickup":return"\u{1F4E6}";case"rejected":return"\u2717";case"completed":return"\u2705";case"needs_revision":return"\u{1F504}";default:return"?"}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),window.removeEventListener("keydown",this.escHandler)}static \u0275fac=function(e){return new(e||n)(y(J),y($),y(V),y(F))};static \u0275cmp=E({type:n,selectors:[["app-my-requests"]],decls:28,vars:6,consts:[[1,"max-w-4xl","mx-auto","p-4"],[1,"flex","items-center","gap-4","mb-6"],["pButton","","type","button","icon","pi pi-arrow-left","aria-label","Back",1,"p-button-text","p-0",3,"click"],[1,"text-2xl","font-semibold"],["class","bg-red-50 text-red-700 p-3 rounded mb-4",4,"ngIf"],[1,"flex","items-center","gap-3","mb-4"],["for","statusFilter",1,"font-medium"],["id","statusFilter","aria-label","Filter requests by status",1,"border","rounded","px-3","py-1",3,"ngModelChange","change","ngModel"],["value","all"],["value","pending"],["value","approved"],["value","ready_for_pickup"],["value","completed"],["value","needs_revision"],["value","rejected"],["class","text-center py-10 text-gray-600",4,"ngIf"],["class","space-y-3",4,"ngIf"],["class","text-center p-8 bg-white rounded shadow",4,"ngIf"],["class","fixed inset-0 bg-black/50 flex items-center justify-center p-4",3,"click",4,"ngIf"],[1,"bg-red-50","text-red-700","p-3","rounded","mb-4"],[1,"text-center","py-10","text-gray-600"],[1,"space-y-3"],["type","button","class","w-full bg-white rounded shadow hover:shadow-md cursor-pointer text-left",3,"click",4,"ngFor","ngForOf"],["type","button",1,"w-full","bg-white","rounded","shadow","hover:shadow-md","cursor-pointer","text-left",3,"click"],[1,"flex","items-start","gap-3","sm:gap-4","p-4"],["aria-hidden","true",1,"w-10","h-10","rounded-full","flex","items-center","justify-center","text-white","font-bold","flex-shrink-0",3,"ngClass"],[1,"flex-1","min-w-0"],[1,"flex","flex-col","gap-2","sm:flex-row","sm:justify-between","sm:items-start"],[1,"text-base","sm:text-lg","font-semibold"],[1,"px-2","py-1","rounded-full","text-xs","font-semibold","w-fit",3,"ngClass"],[1,"text-sm","text-gray-600","mt-2","line-clamp-2"],[1,"text-xs","text-gray-500","mt-2"],[4,"ngIf"],["aria-hidden","true",1,"text-2xl","text-gray-300","hidden","sm:block","flex-shrink-0"],[1,"text-center","p-8","bg-white","rounded","shadow"],[1,"text-gray-500"],["routerLink","/resident/request-document",1,"inline-block","mt-4","px-4","py-2","bg-indigo-600","text-white","rounded"],[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","p-4",3,"click"],["role","dialog","aria-modal","true","aria-labelledby","request-details-title","aria-describedby","request-details-desc",1,"bg-white","rounded-lg","max-w-2xl","w-full","p-6",3,"click"],["id","request-details-close","type","button","aria-label","Close request details",1,"float-right","text-gray-500",3,"click"],["id","request-details-title",1,"text-xl","font-semibold","mb-4"],["id","request-details-desc",1,"space-y-3"],[1,"flex","justify-between"],[3,"ngClass"],["class","flex justify-between",4,"ngIf"],["class","mt-4",4,"ngIf"],["class","",4,"ngIf"],["class","bg-orange-50 p-3 rounded",4,"ngIf"],["class","bg-red-50 p-3 rounded",4,"ngIf"],["class","mt-4 p-3 bg-green-50 text-green-700 rounded",4,"ngIf"],["class","mt-4 p-3 bg-yellow-50 text-yellow-700 rounded",4,"ngIf"],["class","mt-4 p-3 bg-blue-50 text-blue-700 rounded",4,"ngIf"],["class","mt-4 p-3 bg-orange-50 text-orange-700 rounded",4,"ngIf"],["class","mt-4 p-3 bg-red-50 text-red-700 rounded",4,"ngIf"],[1,"mt-4"],[1,"mt-2"],["alt","Uploaded ID",1,"max-w-full","rounded","border",3,"src"],[1,""],[1,"mt-2","text-sm","text-gray-700"],[1,"bg-orange-50","p-3","rounded"],[1,"mt-2","text-sm","text-orange-800"],[1,"bg-red-50","p-3","rounded"],[1,"mt-4","p-3","bg-green-50","text-green-700","rounded"],[1,"mt-4","p-3","bg-yellow-50","text-yellow-700","rounded"],[1,"mt-4","p-3","bg-blue-50","text-blue-700","rounded"],[1,"mt-4","p-3","bg-orange-50","text-orange-700","rounded"],[1,"mt-4","p-3","bg-red-50","text-red-700","rounded"]],template:function(e,o){e&1&&(t(0,"div",0)(1,"div",1)(2,"button",2),x("click",function(){return o.goBack()}),i(),t(3,"h2",3),s(4,"My Document Requests"),i()(),v(5,ee,2,1,"div",4),t(6,"div",5)(7,"label",6),s(8,"Filter by Status:"),i(),t(9,"select",7),T("ngModelChange",function(f){return M(o.statusFilter,f)||(o.statusFilter=f),f}),x("change",function(){return o.filterRequests()}),t(10,"option",8),s(11,"All Requests"),i(),t(12,"option",9),s(13,"Pending"),i(),t(14,"option",10),s(15,"Approved"),i(),t(16,"option",11),s(17,"Ready for Pickup"),i(),t(18,"option",12),s(19,"Completed"),i(),t(20,"option",13),s(21,"Needs Revision"),i(),t(22,"option",14),s(23,"Rejected"),i()()(),v(24,te,2,0,"div",15)(25,se,2,1,"div",16)(26,re,5,0,"div",17)(27,ye,42,23,"div",18),i()),e&2&&(r(5),d("ngIf",o.error),r(4),D("ngModel",o.statusFilter),r(15),d("ngIf",o.loading),r(),d("ngIf",!o.loading&&o.filteredRequests.length>0),r(),d("ngIf",!o.loading&&o.filteredRequests.length===0),r(),d("ngIf",o.selectedRequest))},dependencies:[N,j,B,P,G,z,K,Y,H,W,L,U,X,Q,O,A],styles:[".my-requests-legacy[_ngcontent-%COMP%]{--fallback: transparent}"]})};export{Z as MyRequestsComponent};
