import{b as M,c as E,d as N,e as T,f as k,g as I,h as F,i as O,j as P,k as B,l as A}from"./chunk-CLZ4E3QE.js";import{a as j,b as U}from"./chunk-SDEG5XVJ.js";import{D as a,J as d,K as v,Ka as D,P as S,Pa as q,T as l,U as e,V as t,Xa as _,a as b,bb as x,cb as C,da as y,eb as w,gb as R,i as h,ib as W,qa as i,ra as c,ua as p,va as f,wa as g}from"./chunk-W7V33SUQ.js";import"./chunk-7CGTOI24.js";function V(u,s){if(u&1&&(e(0,"option",20),i(1),t()),u&2){let o=s.$implicit;l("value",o.value),a(),c(o.label)}}var L=class u{constructor(s,o,r,m){this.documentRequestService=s;this.authService=o;this.router=r;this.cdr=m;let n=this.authService.currentUserSubject.value;n&&(this.formData.residentName=n.displayName||n.email||"")}loading=!1;error="";success="";destroy$=new b;formData={documentType:"barangay_clearance",purpose:"",residentName:""};goBack(){this.router.navigate(["/resident"])}submitRequest(){if(this.error="",this.success="",!this.formData.documentType||!this.formData.purpose){this.error="Please fill in all required fields";return}this.loading=!0;let o={residentId:this.authService.currentUserSubject.value?.uid||"",residentName:this.formData.residentName,documentType:this.formData.documentType,purpose:this.formData.purpose,status:"pending",requestDate:new Date};this.documentRequestService.createRequest(o).pipe(h(this.destroy$)).subscribe({next:()=>{this.success="Request submitted successfully! Check your requests to track the status.",this.loading=!1,this.cdr.markForCheck(),setTimeout(()=>{this.router.navigate(["/resident/my-requests"])},2e3)},error:r=>{this.error="Failed to submit request. Please try again.",this.loading=!1,this.cdr.markForCheck()}})}documentTypes=[{value:"barangay_clearance",label:"Barangay Clearance"},{value:"certificate_of_residency",label:"Certificate of Residency"},{value:"certificate_of_indigency",label:"Certificate of Indigency"}];getDocumentDescription(s){switch(s){case"barangay_clearance":return"A certificate issued by the barangay certifying that the applicant is a resident and has no criminal records in the barangay.";case"certificate_of_residency":return"A document certifying that a person is a registered resident of the barangay.";case"certificate_of_indigency":return"A document certifying that the applicant is a resident of low income or indigent status.";default:return""}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(o){return new(o||u)(d(W),d(R),d(x),d(D))};static \u0275cmp=v({type:u,selectors:[["app-request-document"]],decls:58,vars:7,consts:[[1,"max-w-3xl","mx-auto","p-4"],[1,"flex","items-center","gap-4","mb-6"],["pButton","","type","button","icon","pi pi-arrow-left","aria-label","Back",1,"p-button-text","p-0",3,"click"],["id","request-doc-title",1,"text-2xl","font-semibold"],[1,"text-sm","text-gray-600"],[1,"bg-blue-100","border","border-blue-300","rounded","p-4","mb-6","text-blue-900"],["role","form","aria-labelledby","request-doc-title",1,"bg-white","p-6","rounded","shadow","space-y-4",3,"ngSubmit"],[1,"block","font-medium","mb-1"],["type","text","name","residentName","disabled","",1,"w-full","border","rounded","px-3","py-2","bg-gray-100",3,"ngModelChange","ngModel"],[1,"text-red-600"],["aria-required","true","aria-describedby","doc-desc","name","documentType","required","",1,"w-full","border","rounded","px-3","py-2",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["id","doc-desc",1,"mt-2","text-sm","text-gray-600"],["aria-required","true","name","purpose","rows","5","required","","placeholder","Please explain why you need this document",1,"w-full","border","rounded","px-3","py-2",3,"ngModelChange","ngModel"],[1,"flex","flex-col","md:flex-row","gap-3"],["type","submit",1,"flex-1","py-2","rounded","bg-indigo-600","text-white",3,"disabled"],["type","button","routerLink","/resident/my-requests",1,"flex-1","py-2","rounded","bg-gray-600","text-white"],[1,"mt-8","grid","md:grid-cols-2","gap-4"],[1,"p-4","bg-gradient-to-br","from-gray-100","to-gray-200","rounded"],[1,"font-semibold","mb-1"],[3,"value"]],template:function(o,r){o&1&&(e(0,"div",0)(1,"div",1)(2,"button",2),y("click",function(){return r.goBack()}),t(),e(3,"div")(4,"h2",3),i(5,"Request a Document"),t(),e(6,"p",4),i(7,"Submit a request for barangay documents"),t()()(),e(8,"div",5)(9,"strong"),i(10,"Important:"),t(),i(11," Please bring a valid ID to the barangay for verification purposes when you claim your document. No upload is required. "),t(),e(12,"form",6),y("ngSubmit",function(){return r.submitRequest()}),e(13,"div")(14,"label",7),i(15,"Your Name:"),t(),e(16,"input",8),g("ngModelChange",function(n){return f(r.formData.residentName,n)||(r.formData.residentName=n),n}),t()(),e(17,"div")(18,"label",7),i(19,"Document Type: "),e(20,"span",9),i(21,"*"),t()(),e(22,"select",10),g("ngModelChange",function(n){return f(r.formData.documentType,n)||(r.formData.documentType=n),n}),S(23,V,2,2,"option",11),t(),e(24,"div",12),i(25),t()(),e(26,"div")(27,"label",7),i(28,"Purpose: "),e(29,"span",9),i(30,"*"),t()(),e(31,"textarea",13),g("ngModelChange",function(n){return f(r.formData.purpose,n)||(r.formData.purpose=n),n}),t()(),e(32,"div",14)(33,"button",15),i(34),t(),e(35,"button",16),i(36,"Cancel"),t()()(),e(37,"div",17)(38,"div",18)(39,"h4",19),i(40,"1. Submit Request"),t(),e(41,"p",4),i(42,"Fill out the form above and submit your request. Our staff will review it."),t()(),e(43,"div",18)(44,"h4",19),i(45,"2. Approval Review"),t(),e(46,"p",4),i(47,"Staff will review your request and approve or reject it within 1-2 business days."),t()(),e(48,"div",18)(49,"h4",19),i(50,"3. Document Ready"),t(),e(51,"p",4),i(52,"Once approved, you'll be notified when your document is ready for pickup."),t()(),e(53,"div",18)(54,"h4",19),i(55,"4. Pickup"),t(),e(56,"p",4),i(57,"Visit the barangay office to claim your document"),t()()()()),o&2&&(a(16),p("ngModel",r.formData.residentName),a(6),p("ngModel",r.formData.documentType),a(),l("ngForOf",r.documentTypes),a(2),c(r.getDocumentDescription(r.formData.documentType)),a(6),p("ngModel",r.formData.purpose),a(2),l("disabled",r.loading),a(),c(r.loading?"Submitting...":"Submit Request"))},dependencies:[_,q,A,I,O,P,M,F,E,N,B,k,T,w,C,U,j],styles:[".request-document-legacy[_ngcontent-%COMP%]{--fallback: transparent}"]})};export{L as RequestDocumentComponent};
