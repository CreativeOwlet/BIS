<div class="min-h-screen flex bg-gray-50">
  <!-- Sidebar -->
  <aside class="w-64 bg-gradient-to-br from-indigo-500 to-purple-600 text-white p-6 hidden md:block">
    <div class="mb-8">
      <h2 class="text-lg font-semibold">BIS Staff</h2>
    </div>
    <nav class="space-y-1">
      <a (click)="navigateTo('dashboard')" class="block px-3 py-2 rounded hover:bg-white/20 cursor-pointer">ðŸ“Š Dashboard</a>
      <a (click)="navigateTo('residents')" class="block px-3 py-2 rounded hover:bg-white/20 cursor-pointer">ðŸ‘¥ Residents</a>
      <a (click)="navigateTo('requests')" class="block px-3 py-2 rounded hover:bg-white/20 cursor-pointer">ðŸ“‹ Document Requests</a>
      <a (click)="navigateTo('announcements')" class="block px-3 py-2 rounded hover:bg-white/20 cursor-pointer">ðŸ“¢ Announcements</a>
      <a (click)="navigateTo('reports')" class="block px-3 py-2 rounded hover:bg-white/20 cursor-pointer">ðŸ“ˆ Reports</a>
      <a (click)="logout()" class="block px-3 py-2 rounded hover:bg-white/20 cursor-pointer">ðŸšª Logout</a>
    </nav>
  </aside>

  <!-- Main content -->
  <div class="flex-1 p-6">
    <header class="flex items-center justify-between mb-6">
      <div class="flex items-center gap-3">
        <button type="button" class="md:hidden p-2 rounded bg-gray-100" (click)="toggleMobileSidebar()" aria-label="Open sidebar">â˜°</button>
        <h1 class="text-2xl font-bold text-gray-800">Staff Dashboard</h1>
      </div>
      <div class="text-sm text-gray-600"> <span *ngIf="currentUser$ | async as user">Welcome</span></div>
    </header>

    <div *ngIf="loading" class="rounded bg-white p-6 shadow">Loading dashboard data...</div>

    <div *ngIf="error" class="mb-4 p-4 bg-red-50 text-red-700 rounded">{{ error }}</div>

    <div *ngIf="!loading && !error" class="space-y-6">
      <!-- Quick Actions - shown first on mobile -->
      <div class="bg-white p-4 rounded shadow order-1 md:order-2">
        <div class="flex items-center justify-between mb-3">
          <h2 class="text-lg font-semibold">Quick Actions</h2>
          <button (click)="openAddStaff()" class="bg-indigo-600 text-white px-3 py-1 rounded">Add Staff</button>
        </div>
        <div class="flex flex-wrap gap-2">
          <button (click)="navigateTo('residents')" class="px-3 py-2 bg-indigo-100 text-indigo-700 rounded">Add/Manage Residents</button>
          <button (click)="navigateTo('requests')" class="px-3 py-2 bg-indigo-100 text-indigo-700 rounded">Review Requests</button>
          <button (click)="navigateTo('announcements')" class="px-3 py-2 bg-indigo-100 text-indigo-700 rounded">Post Announcement</button>
          <button (click)="navigateTo('reports')" class="px-3 py-2 bg-indigo-100 text-indigo-700 rounded">View Full Reports</button>
        </div>
      </div>

      <!-- Statistics Grid - shown second on mobile -->
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 order-2 md:order-1">
        <div class="bg-white p-4 rounded shadow text-center">
          <h3 class="text-xs font-semibold text-gray-500 uppercase">Total Residents</h3>
          <p class="text-3xl font-bold text-indigo-600">{{ residentReport?.totalResidents || 0 }}</p>
        </div>

        <div class="bg-white p-4 rounded shadow text-center">
          <h3 class="text-xs font-semibold text-gray-500 uppercase">Male</h3>
          <p class="text-3xl font-bold text-indigo-600">{{ residentReport?.totalMale || 0 }}</p>
        </div>

        <div class="bg-white p-4 rounded shadow text-center">
          <h3 class="text-xs font-semibold text-gray-500 uppercase">Female</h3>
          <p class="text-3xl font-bold text-indigo-600">{{ residentReport?.totalFemale || 0 }}</p>
        </div>

        <div class="bg-white p-4 rounded shadow text-center">
          <h3 class="text-xs font-semibold text-gray-500 uppercase">Pending Requests</h3>
          <p class="text-3xl font-bold text-red-500">{{ documentReport?.pendingRequests || 0 }}</p>
        </div>

        <div class="bg-white p-4 rounded shadow text-center">
          <h3 class="text-xs font-semibold text-gray-500 uppercase">Approved Requests</h3>
          <p class="text-3xl font-bold text-green-600">{{ documentReport?.approvedRequests || 0 }}</p>
        </div>

        <div class="bg-white p-4 rounded shadow text-center">
          <h3 class="text-xs font-semibold text-gray-500 uppercase">Ready for Pickup</h3>
          <p class="text-3xl font-bold text-teal-500">{{ documentReport?.readyForPickup || 0 }}</p>
        </div>

        <div class="bg-white p-4 rounded shadow text-center">
          <h3 class="text-xs font-semibold text-gray-500 uppercase">Total Issued</h3>
          <p class="text-3xl font-bold text-indigo-600">{{ documentReport?.totalDocumentsIssued || 0 }}</p>
        </div>

        <div class="bg-white p-4 rounded shadow text-center">
          <h3 class="text-xs font-semibold text-gray-500 uppercase">Barangay Clearance</h3>
          <p class="text-3xl font-bold text-indigo-600">{{ documentReport?.barangayClearance || 0 }}</p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Mobile sidebar overlay -->
<div *ngIf="mobileSidebarOpen" class="fixed inset-0 z-40 md:hidden">
  <div class="absolute inset-0 bg-black/50" (click)="closeMobileSidebar()" aria-hidden="true"></div>
  <aside class="absolute left-0 top-0 bottom-0 w-64 bg-gradient-to-br from-indigo-500 to-purple-600 text-white p-6">
    <div class="mb-8">
      <h2 class="text-lg font-semibold">BIS Staff</h2>
    </div>
    <nav class="space-y-1">
      <button type="button" (click)="navigateTo('dashboard'); closeMobileSidebar()" class="w-full text-left px-3 py-2 rounded hover:bg-white/20">ðŸ“Š Dashboard</button>
      <button type="button" (click)="navigateTo('residents'); closeMobileSidebar()" class="w-full text-left px-3 py-2 rounded hover:bg-white/20">ðŸ‘¥ Residents</button>
      <button type="button" (click)="navigateTo('requests'); closeMobileSidebar()" class="w-full text-left px-3 py-2 rounded hover:bg-white/20">ðŸ“‹ Document Requests</button>
      <button type="button" (click)="navigateTo('announcements'); closeMobileSidebar()" class="w-full text-left px-3 py-2 rounded hover:bg-white/20">ðŸ“¢ Announcements</button>
      <button type="button" (click)="navigateTo('reports'); closeMobileSidebar()" class="w-full text-left px-3 py-2 rounded hover:bg-white/20">ðŸ“ˆ Reports</button>
      <button type="button" (click)="logout(); closeMobileSidebar()" class="w-full text-left px-3 py-2 rounded hover:bg-white/20">ðŸšª Logout</button>
    </nav>
  </aside>
</div>

<!-- Add Staff Modal -->
<div *ngIf="showAddStaffModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg w-full max-w-md p-6">
    <h3 class="text-lg font-semibold mb-3">Add Staff</h3>
    <div *ngIf="error" class="mb-3 p-2 bg-red-50 text-red-700 rounded">{{ error }}</div>
    <div class="grid gap-3">
      <input type="text" [(ngModel)]="newStaff.name" placeholder="Name" class="w-full rounded border-gray-200 p-2" />
      <input type="email" [(ngModel)]="newStaff.email" placeholder="Email" class="w-full rounded border-gray-200 p-2" />
      <input type="password" [(ngModel)]="newStaff.password" placeholder="Password" class="w-full rounded border-gray-200 p-2" />
      <select [(ngModel)]="newStaff.role" class="w-full rounded border-gray-200 p-2">
        <option value="staff">Staff</option>
        <option value="admin">Admin</option>
      </select>
      <input type="password" [(ngModel)]="newStaff.adminPassword" placeholder="Your password (confirm)" class="w-full rounded border-gray-200 p-2" />
      <div *ngIf="createStaffLoading" class="text-sm text-gray-600">Creating staff account...</div>
      <div *ngIf="createStaffSuccess" class="text-sm text-green-600">{{ createStaffSuccess }}</div>
      <div class="flex justify-end gap-2 mt-2">
        <button (click)="createStaff()" class="px-3 py-2 bg-indigo-600 text-white rounded">Create</button>
        <button (click)="closeAddStaff()" class="px-3 py-2 bg-gray-200 rounded">Cancel</button>
      </div>
    </div>
  </div>
</div>
